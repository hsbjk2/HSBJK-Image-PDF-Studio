<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HSBJK Image Compressor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --neon:#00f7ff;
  --pink:#ff2fdc;
  --glass:rgba(255,255,255,0.08);
}

*{box-sizing:border-box;font-family:'Poppins',sans-serif}

body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#0b1a2e,#02040a);
  color:white;
  text-align:center;
}

header{padding:30px}
header h1{
  font-size:40px;
  background:linear-gradient(90deg,var(--neon),var(--pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.upload,.controls{
  max-width:900px;
  margin:20px auto;
  padding:20px;
  background:var(--glass);
  border-radius:18px;
  backdrop-filter:blur(14px);
}

.controls{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}

label{
  font-size:14px;
  opacity:.85;
  display:block;
  margin-bottom:6px;
}

input,select{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  outline:none;
  background:#0c1424;
  color:white;
}

.image-area{
  display:none;
  margin:30px auto;
  width:fit-content;
  box-shadow:0 0 35px var(--neon);
  border-radius:18px;
  overflow:hidden;
}

.image-area img{
  max-width:100%;
  display:block;
}

.info{
  margin-top:10px;
  font-size:14px;
  opacity:.85;
}

button{
  margin:25px;
  padding:14px 30px;
  border:none;
  border-radius:16px;
  font-weight:600;
  cursor:pointer;
  background:linear-gradient(90deg,var(--neon),var(--pink));
  transition:.25s;
}

button:hover{
  transform:scale(1.07);
  box-shadow:0 0 30px var(--neon);
}

footer{opacity:.6;padding:20px}
canvas{display:none}
</style>
</head>

<body>

<header>
  <h1>HSBJK Image Compressor</h1>
  <p>Compress to Specific Size (KB / MB)</p>
</header>

<div class="upload">
  <input type="file" id="upload" accept="image/*">
</div>

<div class="controls">

  <div>
    <label>Target Size</label>
    <input type="number" id="targetSize" placeholder="e.g. 200">
  </div>

  <div>
    <label>Unit</label>
    <select id="unit">
      <option value="kb">KB</option>
      <option value="mb">MB</option>
    </select>
  </div>

  <div>
    <label>Quality (%)</label>
    <input type="number" id="quality" min="1" max="100" value="80">
  </div>

</div>

<div class="image-area" id="imageArea">
  <img id="image">
</div>

<div class="info" id="sizeInfo"></div>

<button onclick="compressImage()">Compress & Download</button>

<footer>© 2025 HSBJK • Image Compressor</footer>

<canvas id="canvas"></canvas>

<script>
const upload=document.getElementById("upload");
const image=document.getElementById("image");
const imageArea=document.getElementById("imageArea");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

const targetSize=document.getElementById("targetSize");
const unit=document.getElementById("unit");
const qualityInput=document.getElementById("quality");
const sizeInfo=document.getElementById("sizeInfo");

let originalSize=0;

upload.onchange=e=>{
  const file=e.target.files[0];
  if(!file) return;
  originalSize=file.size;
  const r=new FileReader();
  r.onload=()=>{
    image.src=r.result;
    image.onload=()=>{
      imageArea.style.display="block";
      sizeInfo.innerText=`Original Size: ${(originalSize/1024).toFixed(2)} KB`;
    }
  };
  r.readAsDataURL(file);
};

function compressImage(){
  canvas.width=image.naturalWidth;
  canvas.height=image.naturalHeight;
  ctx.drawImage(image,0,0);

  let targetBytes = targetSize.value * (unit.value==="mb" ? 1024*1024 : 1024);
  let quality = qualityInput.value / 100;
  let mime = "image/jpeg";
  let dataURL;

  // Auto-adjust quality to reach target size
  for(let i=0;i<10;i++){
    dataURL = canvas.toDataURL(mime,quality);
    let size = Math.round((dataURL.length*3)/4);
    if(size <= targetBytes) break;
    quality -= 0.05;
    if(quality < 0.05) break;
  }

  const finalSize = Math.round((dataURL.length*3)/4);

  sizeInfo.innerText =
    `Original: ${(originalSize/1024).toFixed(2)} KB | ` +
    `Compressed: ${(finalSize/1024).toFixed(2)} KB`;

  const a=document.createElement("a");
  a.download="HSBJK_Compressed.jpg";
  a.href=dataURL;
  a.click();
}
</script>

</body>
</html>
